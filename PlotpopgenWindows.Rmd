---
title: "Plot popgenWindows Notebook"
output: html_notebook
---
The script [popgenWindows.py](https://github.com/simonhmartin/genomics_general) computes some standard population genomic statistics in sliding windows: pi, FST and DXY. The results generated by popgenWindows.py can be read, manipulated and plotted into R however you like, but I have written some functions to make these tasks easier. These functions are provided in the script PlotpopgenWindows.R

### Load libraries
```{r}
library("ggplot2")
library("plyr")
library("dplyr")
```

### Load helpful functions
```{r}
source("PlotpopgenWindows.R")
```

### Import data
Import a file containing the results generated by the script [popgenWindows.py](https://github.com/simonhmartin/genomics_general).
```{r}
Pop = as.data.frame(read.table(file = 'PlotpopgenWindows.out', comment.char = '#', fill = T, sep = ",", header = T))
head(Pop)
```

### Plot the population genomic statistics across the genome
The function ExtOutStat plots the population genomic statistics across the genome and their lower and upper 2.5% quantiles. In addition to the file containing the results generated by the script [popgenWindows.py](https://github.com/simonhmartin/genomics_general), this function required three other parameters. The first parameter is the statistic to be considered in the calculations (i.e. "pi", "dxy", or "Fst"). The second parameter is the species to be considered in the calculations (e.g. "Species1", "Species2", or "Species1_Species2"). The third parameter is the format, i.e. "col" (one column per scaffold), or "row" (one row per scaffold).
```{r}
Plot_Pi_Sp1 <- PlotStatWind(Pop, "pi", "Species1", "row")
print(Plot_Pi_Sp1)
```
```{r}
Plot_Dxy_Sp1Sp2 <- PlotStatWind(Pop, "dxy", "Species1_Species2", "col")
print(Plot_Dxy_Sp1Sp2)
```

### Extract windows having outlier population genomic statistics
The function ExtOutStat extracts the windows having outlier population genomic statistics (higher than the 97.5% quantile). In addition to the file containing the results generated by the script [popgenWindows.py](https://github.com/simonhmartin/genomics_general), this function required two other parameters. The first parameter is the statistic to be considered in the calculations (i.e. "pi", "dxy", or "Fst"). The second parameter is the species to be considered in the calculations (e.g. "Species1", "Species2", or "Species1_Species2").
```{r}
Out_Pi_Sp1 <- ExtOutStat(Pop, "pi", "Species1")
head(Out_Pi_Sp1)
```
```{r}
Out_Dxy_Sp1Sp2 <- ExtOutStat(Pop, "dxy", "Species1_Species2")
head(Out_Dxy_Sp1Sp2)
```
