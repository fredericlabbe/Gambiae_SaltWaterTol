---
title: "Divergence Times Notebook"
output: html_notebook
---
The A00 analysis of BPP ([Yang 2015](https://academic.oup.com/cz/article/61/5/854/1821090)) is used to generate the posterior distribution of parameters on the maximum *a posteriori* tree. The results generated by the A00 analysis of BPP (i.e. *.msmc.txt) can be summarized into R however you like, but I have written some functions to make these tasks easier. These functions are provided in the script DivergenceTimes.R

### Load libraries
```{r}
library("plyr")
library("dplyr")
```

### Load helpful functions
```{r}
source("DivergenceTimes.R")
```

### Import data
Import a file containing the results generated by the A00 analysis of BPP (i.e. *.msmc.txt).
```{r}
Tau = read.table("DivergenceTimes.out", sep = "\t", header = T) 
head(Tau)
```

### Relative divergence times
The function RelDivTime calculates some descriptive statistics (e.g. mean and median) of the relative divergence times (Tau). This function required the file containing the results generated by the A00 analysis of BPP.
```{r}
Rel <- RelDivTime(Tau)
write.table(Rel, "Rel_Div_Time_Gen.txt", row.names = F, col.names = T, quote = F, sep = "\t")
print(Rel)
```

### Absolute divergence times in generations
The function AbsDivTimeGen calculates some descriptive statistics (e.g. mean and median) of the absolute divergence times in generations. In addition to the file containing the results generated by the A00 analysis of BPP, this function requires the mutation rate (e.g. 2.8e-09).
```{r}
Gen <- AbsDivTimeGen(Tau, 2.8e-09)
write.table(Gen, "Abs_Div_Time_Gen.txt", row.names = F, col.names = T, quote = F, sep = "\t")
print(Gen)
```

### Absolute divergence times in years
The function AbsDivTimeYea calculates some descriptive statistics (e.g. mean and median) of the absolute divergence times in years. In addition to the file containing the results generated by the A00 analysis of BPP, this function required two other parameters. The first parameter is the mutation rate (e.g. 2.8e-09), and the second parameter is the number of generations per year (e.g. 11).
```{r}
Yea <- AbsDivTimeYea(Tau, 2.8e-09, 11)
write.table(Yea, "Abs_Div_Time_Yea.txt", row.names = F, col.names = T, quote = F, sep = "\t")
print(Yea)
```
